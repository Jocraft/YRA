{% extends 'base.html' %}

{% block title %}
  Analysis | Youth Road Analyzer
{% endblock title %}

{% block content %}
<div class="analysis-page">
  <h1 class="analysis-title">Data Analysis</h1>

  <form class="analysis-form" method="POST">
    {% csrf_token %}
    <div class="form-group">
      <label for="column">Select a Column for Analysis:</label>
      {{ form.column }}
    </div>

    <div class="form-group">
      <label for="group_by">Group By (Optional):</label>
      {{ form.group_by }}
    </div>

    <button class="analysis-button" type="submit">Analyze</button>
  </form>

  {% if plot_html %}
    <div class="analysis-section analysis-plot-section">
      <h2 class="analysis-subtitle">Plot for Selected Column</h2>
      <div class="analysis-plot-container">
        {{ plot_html|safe }}
      </div>
    </div>
  {% endif %}

  {% if statistics %}
    <div class="analysis-section analysis-statistics-section">
      <h2 class="analysis-subtitle">Statistics for Selected Column</h2>
      <ul class="analysis-statistics-list">
        {% for key, value in statistics.items %}
          <li>
            <strong>{{ key }}</strong>:
            {% if value|length > 1 and value.items %}
              <ul class="analysis-sublist">
                {% for sub_key, sub_value in value.items %}
                  <li>{{ sub_key }}: {{ sub_value }}</li>
                {% endfor %}
              </ul>
            {% else %}
              {{ value }}
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  {% if column_values %}
    <div class="analysis-section analysis-values-section">
      <h2 class="analysis-subtitle">Raw Values for Selected Column</h2>
      <ul class="analysis-values-list">
        {% for value in column_values %}
          <li>{{ value }}</li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}
</div>
{% endblock content %}

{% block js %}
  <!-- Add any specific JavaScript needed here -->
{% endblock js %}
